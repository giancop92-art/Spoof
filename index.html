<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chef Academy - Pro UI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #ffffff; color: #1e293b; touch-action: none; overflow: hidden; }
        
        /* Ruler Styling */
        .ruler-container {
            position: relative;
            width: 100%;
            height: 100px;
            overflow: hidden;
            cursor: grab;
            background: #f8fafc;
            border-top: 1px solid #f1f5f9;
        }
        .ruler-track {
            display: flex;
            align-items: flex-end;
            height: 100%;
            position: absolute;
            left: 50%;
            transition: transform 0.1s ease-out;
            will-change: transform;
        }
        .tack { width: 2px; background: #e2e8f0; margin-right: 20px; flex-shrink: 0; }
        .tack.major { height: 35px; background: #cbd5e1; position: relative; }
        .tack.major::after {
            content: attr(data-val);
            position: absolute;
            top: -22px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 9px;
            font-weight: 800;
            color: #94a3b8;
        }
        .tack.minor { height: 15px; }
        .ruler-pointer {
            position: absolute;
            left: 50%;
            bottom: 0;
            width: 4px;
            height: 50px;
            background: #f59e0b;
            transform: translateX(-50%);
            z-index: 20;
            border-radius: 4px 4px 0 0;
        }

        /* Ingredient Card */
        .food-card {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid transparent;
        }
        .food-card.active {
            background: #fffbeb;
            border-color: #f59e0b;
            transform: scale(1.05);
        }
        .food-card.active img { transform: scale(1.1); }

        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="flex justify-center">

    <div class="w-full max-w-[460px] h-screen flex flex-col bg-white">
        
        <div class="px-8 pt-8 pb-4">
            <div class="bg-slate-900 rounded-[3rem] p-6 shadow-2xl text-white">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-5">
                        <div class="relative">
                            <img id="heroIcon" src="spoon.png" class="w-16 h-16 object-contain">
                            <div id="multiplier" class="absolute -bottom-1 -right-1 bg-amber-500 text-slate-900 text-[10px] font-black px-2 py-0.5 rounded-lg shadow-lg">x0</div>
                        </div>
                        <div>
                            <span id="resultUnits" class="text-4xl font-black">0.0</span>
                            <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mt-1">Unit√† Calcolate</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span id="kcalVal" class="text-lg font-bold text-amber-500">0</span>
                        <p class="text-[8px] font-bold text-slate-600 uppercase">Kcal</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex-1 px-4 overflow-y-auto no-scrollbar py-4">
            <div class="grid grid-cols-3 gap-3" id="ingredientGrid">
                </div>
        </div>

        <div class="bg-slate-50 border-t border-slate-100 pt-6">
            <div class="text-center mb-4">
                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Peso Selezionato</span>
                <div class="text-4xl font-black text-slate-800"><span id="gramsDisplay">0</span><span class="text-base text-amber-500 ml-1">g</span></div>
            </div>
            
            <div class="ruler-container" id="ruler">
                <div class="ruler-pointer"></div>
                <div class="ruler-track" id="track"></div>
            </div>
        </div>

        <div class="p-6 grid grid-cols-4 gap-2 bg-white border-t border-slate-100">
            <button onclick="selectTool('cucchiaio')" id="tool-cucchiaio" class="py-3 rounded-xl bg-slate-50 text-[9px] font-black uppercase border-2 border-transparent transition-all">Spoon</button>
            <button onclick="selectTool('cucchiaino')" id="tool-cucchiaino" class="py-3 rounded-xl bg-slate-50 text-[9px] font-black uppercase border-2 border-transparent transition-all">T-Spoon</button>
            <button onclick="selectTool('tazzina')" id="tool-tazzina" class="py-3 rounded-xl bg-slate-50 text-[9px] font-black uppercase border-2 border-transparent transition-all">Cup</button>
            <button onclick="selectTool('bicchiere')" id="tool-bicchiere" class="py-3 rounded-xl bg-slate-50 text-[9px] font-black uppercase border-2 border-transparent transition-all">Glass</button>
        </div>
    </div>

    <script>
        const db = {
            farina: { name: "Farina", img: "flour.png", w: { cucchiaio: 12, cucchiaino: 4, tazzina: 60, bicchiere: 120 }, kcal: 364 },
            olio: { name: "Olio", img: "oil.png", w: { cucchiaio: 9, cucchiaino: 3, tazzina: 80, bicchiere: 180 }, kcal: 884 },
            zucchero: { name: "Zucchero", img: "sugar.png", w: { cucchiaio: 15, cucchiaino: 5, tazzina: 80, bicchiere: 180 }, kcal: 387 },
            sale: { name: "Sale", img: "salt.png", w: { cucchiaio: 18, cucchiaino: 6, tazzina: 110, bicchiere: 250 }, kcal: 0 },
            riso: { name: "Riso", img: "rice.png", w: { cucchiaio: 20, cucchiaino: 7, tazzina: 90, bicchiere: 220 }, kcal: 130 },
            latte: { name: "Latte", img: "milk.png", w: { cucchiaio: 15, cucchiaino: 5, tazzina: 70, bicchiere: 200 }, kcal: 64 }
        };

        const toolIcons = { cucchiaio: "spoon.png", cucchiaino: "teaspoon.png", tazzina: "mug.png", bicchiere: "glass.png" };
        let state = { food: 'farina', tool: 'cucchiaio', grams: 0 };

        function init() {
            const grid = document.getElementById('ingredientGrid');
            Object.keys(db).forEach(key => {
                const card = document.createElement('div');
                card.id = `food-${key}`;
                card.className = `food-card p-4 rounded-[2rem] bg-slate-50 flex flex-col items-center cursor-pointer ${key === state.food ? 'active' : ''}`;
                card.onclick = () => selectFood(key);
                card.innerHTML = `
                    <img src="${db[key].img}" class="w-14 h-14 object-contain mb-2">
                    <span class="text-[10px] font-black uppercase text-slate-600">${db[key].name}</span>
                `;
                grid.appendChild(card);
            });

            const track = document.getElementById('track');
            for(let i=0; i<=500; i+=5) {
                const tack = document.createElement('div');
                tack.className = i % 25 === 0 ? 'tack major' : 'tack minor';
                if(i % 50 === 0) tack.setAttribute('data-val', i);
                track.appendChild(tack);
            }
            updateUI();
        }

        let isDragging = false, startX, currentTranslate = 0, prevTranslate = 0;
        const ruler = document.getElementById('ruler');
        const track = document.getElementById('track');

        ruler.addEventListener('touchstart', e => { isDragging = true; startX = e.touches[0].clientX; });
        window.addEventListener('touchmove', e => {
            if (!isDragging) return;
            const x = e.touches[0].clientX;
            currentTranslate = Math.min(0, Math.max(-4500, prevTranslate + (x - startX) * 1.5));
            track.style.transform = `translateX(${currentTranslate}px)`;
            state.grams = Math.abs(Math.round(currentTranslate / 22) * 5);
            updateUI();
        });
        window.addEventListener('touchend', () => { isDragging = false; prevTranslate = currentTranslate; });

        // Aggiunto supporto Mouse per test
        ruler.addEventListener('mousedown', e => { isDragging = true; startX = e.clientX; });
        window.addEventListener('mousemove', e => {
            if (!isDragging) return;
            currentTranslate = Math.min(0, Math.max(-4500, prevTranslate + (e.clientX - startX) * 1.5));
            track.style.transform = `translateX(${currentTranslate}px)`;
            state.grams = Math.abs(Math.round(currentTranslate / 22) * 5);
            updateUI();
        });
        window.addEventListener('mouseup', () => { isDragging = false; prevTranslate = currentTranslate; });

        function selectFood(f) {
            state.food = f;
            document.querySelectorAll('.food-card').forEach(c => c.classList.remove('active'));
            document.getElementById(`food-${f}`).classList.add('active');
            updateUI();
        }

        function selectTool(t) {
            state.tool = t;
            document.querySelectorAll('button[onclick^="selectTool"]').forEach(b => b.classList.remove('bg-amber-500', 'text-white', 'border-amber-600'));
            const btn = document.getElementById(`tool-${t}`);
            btn.classList.add('bg-amber-500', 'text-white');
            document.getElementById('heroIcon').src = toolIcons[t];
            updateUI();
        }

        function updateUI() {
            const food = db[state.food];
            const units = state.grams / food.w[state.tool];
            document.getElementById('gramsDisplay').textContent = state.grams;
            document.getElementById('resultUnits').textContent = units.toFixed(1);
            document.getElementById('multiplier').textContent = `x${Math.floor(units)}`;
            document.getElementById('kcalVal').textContent = Math.round((food.kcal * state.grams) / 100);
        }

        window.onload = init;
    </script>
</body>
</html>
