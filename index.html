<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chef Academy - Ruler UI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #ffffff; color: #1e293b; touch-action: none; overflow: hidden; }
        
        /* Estetica Righello Custom */
        .ruler-container {
            position: relative;
            width: 100%;
            height: 120px;
            overflow: hidden;
            cursor: grab;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            border-bottom: 1px solid #e2e8f0;
        }
        .ruler-track {
            display: flex;
            align-items: flex-end;
            height: 100%;
            position: absolute;
            left: 50%;
            transition: transform 0.1s ease-out;
            will-change: transform;
        }
        .tack {
            width: 2px;
            background: #cbd5e1;
            margin-right: 20px;
            flex-shrink: 0;
        }
        .tack.major { height: 40px; background: #94a3b8; position: relative; }
        .tack.major::after {
            content: attr(data-val);
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 800;
            color: #64748b;
        }
        .tack.minor { height: 20px; }
        .ruler-pointer {
            position: absolute;
            left: 50%;
            bottom: 0;
            width: 4px;
            height: 60px;
            background: #f59e0b;
            transform: translateX(-50%);
            z-index: 20;
            border-radius: 2px 2px 0 0;
        }

        /* Card Risultato */
        .output-card {
            background: #1e293b;
            border-radius: 3rem;
            padding: 2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            color: white;
            transition: transform 0.2s ease;
        }

        .food-btn.active { background: #f1f5f9; border-color: #f59e0b; }
        .tool-chip.active { background: #f59e0b; color: white; }
    </style>
</head>
<body class="flex justify-center">

    <div class="w-full max-w-[460px] h-screen flex flex-col">
        
        <div class="p-6 flex justify-between items-center">
            <span class="text-[10px] font-extrabold tracking-[0.3em] uppercase text-slate-400">Precision Scale</span>
            <div class="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center">
                <div class="w-2 h-2 bg-amber-500 rounded-full animate-pulse"></div>
            </div>
        </div>

        <div class="px-6 py-4 flex-1 flex flex-col justify-center">
            <div class="output-card relative overflow-hidden">
                <div class="flex items-center justify-between relative z-10">
                    <div class="flex items-center space-x-6">
                        <div class="relative">
                            <img id="heroIcon" src="spoon.png" class="w-20 h-20 object-contain drop-shadow-2xl">
                            <div id="multiplier" class="absolute -bottom-2 -right-2 bg-amber-500 text-slate-900 text-xs font-black px-3 py-1 rounded-xl">x0</div>
                        </div>
                        <div>
                            <h2 id="resultUnits" class="text-5xl font-black leading-tight">0.0</h2>
                            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Unit√† Totali</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p id="kcalVal" class="text-xl font-black text-amber-500">0</p>
                        <p class="text-[9px] font-bold text-slate-500 uppercase">Kcal</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="px-6 py-4 flex space-x-4 overflow-x-auto no-scrollbar">
            <button onclick="selectFood('farina')" id="food-farina" class="food-btn active flex-shrink-0 w-16 h-16 border-2 border-transparent rounded-2xl flex items-center justify-center transition-all">
                <img src="flour.png" class="w-10 h-10 object-contain">
            </button>
            <button onclick="selectFood('olio')" id="food-olio" class="food-btn flex-shrink-0 w-16 h-16 border-2 border-transparent rounded-2xl flex items-center justify-center transition-all">
                <img src="oil.png" class="w-10 h-10 object-contain">
            </button>
            <button onclick="selectFood('zucchero')" id="food-zucchero" class="food-btn flex-shrink-0 w-16 h-16 border-2 border-transparent rounded-2xl flex items-center justify-center transition-all">
                <img src="sugar.png" class="w-10 h-10 object-contain">
            </button>
            <button onclick="selectFood('sale')" id="food-sale" class="food-btn flex-shrink-0 w-16 h-16 border-2 border-transparent rounded-2xl flex items-center justify-center transition-all">
                <img src="salt.png" class="w-10 h-10 object-contain">
            </button>
        </div>

        <div class="flex flex-col items-center bg-slate-50 pb-8">
            <div class="text-4xl font-black text-slate-800 mb-4 mt-6"><span id="gramsDisplay">0</span><span class="text-lg text-slate-400 ml-1">g</span></div>
            
            <div class="ruler-container" id="ruler">
                <div class="ruler-pointer"></div>
                <div class="ruler-track" id="track">
                    </div>
            </div>
        </div>

        <div class="p-6 grid grid-cols-4 gap-2 bg-white border-t">
            <button onclick="selectTool('cucchiaio')" id="tool-cucchiaio" class="tool-chip active py-3 rounded-xl bg-slate-100 text-[10px] font-black uppercase transition-all">Spoon</button>
            <button onclick="selectTool('cucchiaino')" id="tool-cucchiaino" class="tool-chip py-3 rounded-xl bg-slate-100 text-[10px] font-black uppercase transition-all">T-Spoon</button>
            <button onclick="selectTool('tazzina')" id="tool-tazzina" class="tool-chip py-3 rounded-xl bg-slate-100 text-[10px] font-black uppercase transition-all">Cup</button>
            <button onclick="selectTool('bicchiere')" id="tool-bicchiere" class="tool-chip py-3 rounded-xl bg-slate-100 text-[10px] font-black uppercase transition-all">Glass</button>
        </div>
    </div>

    <script>
        const db = {
            farina: { weights: { cucchiaio: 12, cucchiaino: 4, tazzina: 60, bicchiere: 120 }, kcal: 364 },
            olio: { weights: { cucchiaio: 9, cucchiaino: 3, tazzina: 80, bicchiere: 180 }, kcal: 884 },
            zucchero: { weights: { cucchiaio: 15, cucchiaino: 5, tazzina: 80, bicchiere: 180 }, kcal: 387 },
            sale: { weights: { cucchiaio: 18, cucchiaino: 6, tazzina: 110, bicchiere: 250 }, kcal: 0 }
        };

        let state = { food: 'farina', tool: 'cucchiaio', grams: 0 };
        const track = document.getElementById('track');
        const ruler = document.getElementById('ruler');

        // Generazione tacche righello
        function createRuler() {
            for(let i=0; i<=500; i+=5) {
                const tack = document.createElement('div');
                tack.className = i % 25 === 0 ? 'tack major' : 'tack minor';
                if(i % 50 === 0) tack.setAttribute('data-val', i);
                track.appendChild(tack);
            }
        }

        // Logica Slider (Mouse e Touch)
        let isDragging = false;
        let startX, currentTranslate = 0, prevTranslate = 0;

        ruler.addEventListener('mousedown', startDrag);
        ruler.addEventListener('touchstart', startDrag);
        window.addEventListener('mousemove', drag);
        window.addEventListener('touchmove', drag);
        window.addEventListener('mouseup', endDrag);
        window.addEventListener('touchend', endDrag);

        function startDrag(e) {
            isDragging = true;
            startX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
            ruler.style.cursor = 'grabbing';
        }

        function drag(e) {
            if (!isDragging) return;
            const x = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
            const walk = (x - startX) * 1.5;
            currentTranslate = prevTranslate + walk;
            
            // Limiti slider
            if (currentTranslate > 0) currentTranslate = 0;
            if (currentTranslate < -4500) currentTranslate = -4500;

            track.style.transform = `translateX(${currentTranslate}px)`;
            
            // Calcolo Grammi (ogni 22px = 5 grammi circa)
            state.grams = Math.abs(Math.round(currentTranslate / 22) * 5);
            updateUI();
        }

        function endDrag() {
            isDragging = false;
            prevTranslate = currentTranslate;
            ruler.style.cursor = 'grab';
        }

        function selectFood(f) {
            state.food = f;
            document.querySelectorAll('.food-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`food-${f}`).classList.add('active');
            updateUI();
        }

        function selectTool(t) {
            state.tool = t;
            document.querySelectorAll('.tool-chip').forEach(b => b.classList.remove('active'));
            document.getElementById(`tool-${t}`).classList.add('active');
            updateUI();
        }

        function updateUI() {
            const food = db[state.food];
            const units = state.grams / food.weights[state.tool];
            
            document.getElementById('gramsDisplay').textContent = state.grams;
            document.getElementById('resultUnits').textContent = units.toFixed(1);
            document.getElementById('multiplier').textContent = `x${Math.floor(units)}`;
            document.getElementById('kcalVal').textContent = Math.round((food.kcal * state.grams) / 100);
            
            // Feedback sull'icona hero
            document.getElementById('heroIcon').style.transform = `scale(${0.8 + (units > 0 ? 0.2 : 0)})`;
            document.getElementById('heroIcon').style.opacity = units > 0 ? '1' : '0.3';
        }

        window.onload = () => { createRuler(); updateUI(); };
    </script>
</body>
</html>
